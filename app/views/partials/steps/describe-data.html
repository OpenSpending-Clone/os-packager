{% raw %}
<section ng-if="currentStep.id == 'describe-data'" ng-controller="DescribeDataController">
  <h2>Step {{ currentStep.order }}. {{ currentStep.title }}</h2>
  <div class="row form-group" ng-repeat="resource in resources track by $index">
    <div class="col-xs-12">

      <div class="table-responsive">
        <table class="table table-condensed" cellpadding="0" cellspacing="0" border="0">
          <tbody ng-init="sizeOfDataSample = (resource.data.rows.length > 3 ? 3 : resource.data.rows.length) + 1">
          <!-- Several rows of sample of data -->
          <tr class="success">
            <td colspan="{{ resource.schema.fields.length + 1 }}">
              <b>Sample of data ({{ sizeOfDataSample }} {{ sizeOfDataSample == 1 ? 'row' : 'rows' }})</b>
            </td>
          </tr>
          <tr>
            <td class="info" rowspan="{{ sizeOfDataSample }}"></td>
            <td ng-repeat="header in resource.data.headers track by $index"><b>{{ header }}</b></td>
          </tr>
          <tr ng-repeat="row in resource.data.rows | limitTo:3 track by $index">
            <td ng-repeat="value in row track by $index">{{ value }}</td>
          </tr>

          <!-- Editors -->
          <tr class="success">
            <td colspan="{{ resource.schema.fields.length + 1 }}"><b>Description</b></td>
          </tr>

          <!-- Title of field -->
          <tr>
            <td class="info">Title</td>
            <td ng-repeat="field in resource.schema.fields track by $index">
              <input ng-model="field.title" type="text" class="form-control">
            </td>
          </tr>
          <!-- Description of field -->
          <tr>
            <td class="info">Description</td>
            <td ng-repeat="field in resource.schema.fields track by $index">
              <textarea ng-model="field.description" class="form-control resize-vertical"></textarea>
            </td>
          </tr>
          <!-- Data type -->
          <tr>
            <td class="info">Data type</td>
            <td ng-repeat="field in resource.schema.fields track by $index">
              <select ng-model="field.type" class="form-control"
                ng-options="item.id as item.name for item in availableDataTypes"></select>
            </td>
          </tr>
          <!-- Concept (measures) -->
          <tr>
            <td class="info">Concept</td>
            <td ng-repeat="field in resource.schema.fields track by $index">
              <select ng-model="field.concept" class="form-control"
                ng-options="item.id as item.name for item in availableConcepts"></select>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="row form-group">
    <div class="col-xs-12">
      <button type="button" ng-click="goToNextStep()" class="btn btn-primary btn-lg">Next <i class="glyphicon glyphicon-chevron-right"></i></button>
    </div>
  </div>
</section>
{% endraw %}